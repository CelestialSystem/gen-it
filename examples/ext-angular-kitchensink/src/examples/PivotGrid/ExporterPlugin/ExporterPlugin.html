<ExtContainer layout="fit" padding="10" fitToParent="true">
    <ExtToolbar
        docked="top"
        ui="app-transparent-toolbar"
        [shadow]="false"
        [margin]="isPhone ? '0 10' : '10 0 0 10'"
        padding="0 10 0 10"
        [defaults]="{ margin: '0 10 0 0', shadow: true, ui: 'action' }"
    >
        <ExtButton
            text="Configurator"
            [handler]="this.showConfigurator"
        ></ExtButton>
        <ExtButton text="Export to ...">
            <ExtMenu
                [defaults]="{
                    handler: this.exportDocument,
                    iconCls: 'x-fa fa-file-tExtO'
                }"
            >
                <ExtMenuitem
                    text="Excel xlsx (pivot table definition)"
                    iconCls="x-fa fa-file-excel-o"
                    [config]="{
                        type: 'pivotxlsx',
                        matrix: true,
                        fileName: 'ExportPivot.xlsx'
                    }"
                >
                </ExtMenuitem>
                <ExtMenuitem
                    text="Excel xlsx (all items)"
                    iconCls="x-fa fa-file-excel-o"
                    [config]="{ type: 'excel07', fileName: 'ExportAll.xlsx' }"
                >
                </ExtMenuitem>
                <ExtMenuitem
                    text="Excel xlsx (visible items)"
                    iconCls="x-fa fa-file-excel-o"
                    [config]="{
                        type: 'excel07',
                        fileName: 'ExportVisible.xlsx',
                        onlyExpandedNodes: true
                    }"
                >
                </ExtMenuitem>
                <ExtMenuitem
                    text="Excel xml (all items)"
                    iconCls="x-fa fa-file-excel-o"
                    [config]="{ type: 'excel03', fileName: 'ExportAll.xml' }"
                >
                </ExtMenuitem>
                <ExtMenuitem
                    text="Excel xml (visible items)"
                    iconCls="x-fa fa-file-excel-o"
                    [config]="{
                        type: 'excel03',
                        fileName: 'ExportVisible.xml',
                        onlyExpandedNodes: true
                    }"
                >
                </ExtMenuitem>
                <ExtMenuitem
                    text="CSV (all items)"
                    [config]="{ type: 'csv', fileName: 'ExportAll.csv' }"
                >
                </ExtMenuitem>
                <ExtMenuitem
                    text="CSV (visible items)"
                    [config]="{
                        type: 'csv',
                        fileName: 'ExportVisible.csv',
                        onlyExpandedNodes: true
                    }"
                >
                </ExtMenuitem>
                <ExtMenuitem
                    text="TSV (all items)"
                    [config]="{ type: 'tsv', fileName: 'ExportAll.csv' }"
                >
                </ExtMenuitem>
                <ExtMenuitem
                    text="TSV (visible items)"
                    [config]="{
                        type: 'tsv',
                        fileName: 'ExportVisible.csv',
                        onlyExpandedNodes: true
                    }"
                >
                </ExtMenuitem>
                <ExtMenuitem
                    text="HTML (all items)"
                    iconCls="x-fa fa-html5"
                    [config]="{ type: 'html', fileName: 'ExportAll.html' }"
                >
                </ExtMenuitem>
                <ExtMenuitem
                    text="HTML (visible items)"
                    iconCls="x-fa fa-html5"
                    [config]="{
                        type: 'html',
                        fileName: 'ExportVisible.html',
                        onlyExpandedNodes: true
                    }"
                >
                </ExtMenuitem>
            </ExtMenu>
        </ExtButton>
    </ExtToolbar>

    <ExtPivotgrid
        [shadow]="true"
        [plugins]="pivotgridPlugins"
        [matrix]="pivotGridMatrix"
        (ready)="onPivotGridRead($event)"
        (onDocumentSave)="(this.onDocumentSave)"
        (onBeforeDocumentSave)="(this.onBeforeDocumentSave)"
    >
    </ExtPivotgrid>
</ExtContainer>
